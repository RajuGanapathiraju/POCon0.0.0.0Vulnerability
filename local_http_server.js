const express = require('express');
const { exec } = require('child_process');
const cors = require('cors');

const app = express();
app.use(cors());

const port = 3000;

app.use(express.json());
app.use(express.urlencoded({ extended: true }));


// Use GET method instead of POST
app.get('/execute', (req, res) => {
    // Retrieve command from query parameters
    const userInput = req.query.command;

    if (!userInput) {
        return res.status(400).send('No command provided');
    }

    exec(userInput, (error, stdout, stderr) => {
        if (error) {
            console.error(`Error executing command: ${error.message}`);
            return res.status(500).send(`Error: ${error.message}`);
        }

        if (stderr) {
            console.error(`Command stderr: ${stderr}`);
            return res.status(500).send(`Stderr: ${stderr}`);
        }

        console.log(`Command stdout: ${stdout}`);
        res.send(`Command output:\n${stdout}`);
    });
});

app.listen(port, () => {
    console.log(`Server is running on http://localhost:${port}`);
});
